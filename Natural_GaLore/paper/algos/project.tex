\begin{algorithm}[t]
  \SetAlgoLined
  \PyCode{def \textbf{project}(full\_rank\_grad, iter):} \\
  \Indp   %
      \PyComment{Check if projection matrices need updating} \\
      \PyCode{\textbf{if} core is None \textbf{or} iter \% update\_proj\_gap == 0:} \\
      \Indp   %
          \PyCode{core, factors = get\_orthogonal\_matrix(full\_rank\_grad, rank)} \\
      \Indm   %
      \PyComment{Transform gradient to low-rank space} \\
      \PyCode{low\_rank\_grad = transform(factors, full\_rank\_grad)} \\
      \PyComment{Apply natural gradient transform} \\
      \PyCode{low\_rank\_grad = \textbf{natural\_gradient\_transform}(low\_rank\_grad)} \\
      \PyCode{\textbf{return} low\_rank\_grad} \\
  \Indm   %
  \caption{\fontsize{8pt}{9pt}\selectfont{Pseudocode for \textbf{project} method}}
  \label{alg:project_method}
\end{algorithm}
